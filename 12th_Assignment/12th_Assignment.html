<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="서강대학교 20121802 김재현">
<meta name="dcterms.date" content="2023-11-29">

<title>12th_Assignment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="12th_Assignment_files/libs/clipboard/clipboard.min.js"></script>
<script src="12th_Assignment_files/libs/quarto-html/quarto.js"></script>
<script src="12th_Assignment_files/libs/quarto-html/popper.min.js"></script>
<script src="12th_Assignment_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="12th_Assignment_files/libs/quarto-html/anchor.min.js"></script>
<link href="12th_Assignment_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="12th_Assignment_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="12th_Assignment_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="12th_Assignment_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="12th_Assignment_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">12th_Assignment</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>서강대학교 20121802 김재현 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 29, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="회귀분석을-이용하여-예측값에-대한-오차는-어떠한-요인에-의하여-영향을-받는지를-논의하시오." class="level2">
<h2 class="anchored" data-anchor-id="회귀분석을-이용하여-예측값에-대한-오차는-어떠한-요인에-의하여-영향을-받는지를-논의하시오.">1. 회귀분석을 이용하여 예측값에 대한 오차는 어떠한 요인에 의하여 영향을 받는지를 논의하시오.</h2>
<section id="비선형" class="level3">
<h3 class="anchored" data-anchor-id="비선형">1.1 비선형</h3>
<p>만약 모집단이 비선형이면, 회귀분석을 이용하여 회귀모형으로 적합할 경우 잔차가 무작위가 아닌 특별한 패턴을 갖는다.</p>
</section>
<section id="오차항의-독립성" class="level3">
<h3 class="anchored" data-anchor-id="오차항의-독립성">1.2 오차항의 독립성</h3>
<p>잔차가 서로 독립적이지 않다면, 잔차가 서로에게 영향을 준다는 것이다.</p>
</section>
<section id="오차항의-기대값이-0-불편성" class="level3">
<h3 class="anchored" data-anchor-id="오차항의-기대값이-0-불편성">1.3 오차항의 기대값이 0 (불편성)</h3>
<p>불편성을 만족하지 못한다면, 데이터 측정 과정에서 오차가 발생했을 가능성이 있다. 이는 오차에 바이어스를 가져다 준다.</p>
</section>
<section id="오차항의-등분산성" class="level3">
<h3 class="anchored" data-anchor-id="오차항의-등분산성">1.4 오차항의 등분산성</h3>
<p>잔차의 등분산성이 깨지면 <span class="math inline">\(\hat{y}\)</span> 값에 따라 잔차가 패턴을 갖는다. 등분산성이 깨졌다는 것을 확인하면, 변수 변환을 통해 등분산성을 갖도록 해야 한다.</p>
</section>
<section id="오차항의-정규성" class="level3">
<h3 class="anchored" data-anchor-id="오차항의-정규성">1.5 오차항의 정규성</h3>
<p>오차항이 정규분포를 이룬다고 가정하나 이는 가우스 마코브 정리에 따라 완화하여 적용할 수 있다.</p>
</section>
<section id="영향점" class="level3">
<h3 class="anchored" data-anchor-id="영향점">1.6 영향점</h3>
<p>잔차가 극단값을 갖고 레버리지가 큰 관측값은 영향점일 가능성이 크다. 영향점은 회귀모형을 적합하는데 지대한 영향을 미쳐서, 예상과 전혀 다른 모형을 적합하게 하기도 한다.</p>
</section>
<section id="다중공선성" class="level3">
<h3 class="anchored" data-anchor-id="다중공선성">1.7 다중공선성</h3>
<p>독립변수간에 높은 상관관계가 있는 경우 분산이 팽창하여 모형 정확도가 떨어지고 회귀계수나 예측값에 대하여 안정적인 결과를 제공하지 못한다.</p>
</section>
</section>
<section id="경로분석-문제-22장에-소개된-아파트-매매자료를-이용하여-다음-물음에-답하시오." class="level2">
<h2 class="anchored" data-anchor-id="경로분석-문제-22장에-소개된-아파트-매매자료를-이용하여-다음-물음에-답하시오.">4. (경로분석 문제) 22장에 소개된 아파트 매매자료를 이용하여 다음 물음에 답하시오.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="st">"apartment.xlsx"</span>,<span class="at">range =</span> <span class="st">"B4:E30"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Sales   Dur  Area Rooms
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  138     74    21     4
2  246    320    54     7
3  242.   160    49     6
4  145.   175    24     4
5  186     69    31     6
6  182.   151    28     4</code></pre>
</div>
</div>
<section id="종속변수를-아파트-매매가격으로-하고-독립변수를-면적과-방의-수로-하여-다중회귀분석을-실시하고-여기서-추정된-회귀계수의-의미에-대하여-설명하시오." class="level3">
<h3 class="anchored" data-anchor-id="종속변수를-아파트-매매가격으로-하고-독립변수를-면적과-방의-수로-하여-다중회귀분석을-실시하고-여기서-추정된-회귀계수의-의미에-대하여-설명하시오.">(1) 종속변수를 아파트 매매가격으로 하고, 독립변수를 면적과 방의 수로 하여 다중회귀분석을 실시하고, 여기서 추정된 회귀계수의 의미에 대하여 설명하시오.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">=</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> Area <span class="sc">+</span> Rooms, data1)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ Area + Rooms, data = data1)

Residuals:
    Min      1Q  Median      3Q     Max 
-44.854 -12.761   0.211  14.060  32.263 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  54.1930    20.7853   2.607   0.0158 *  
Area          4.4336     0.6563   6.755 6.86e-07 ***
Rooms        -0.3934     6.1039  -0.064   0.9492    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.91 on 23 degrees of freedom
Multiple R-squared:  0.8219,    Adjusted R-squared:  0.8064 
F-statistic: 53.06 on 2 and 23 DF,  p-value: 2.418e-09</code></pre>
</div>
</div>
<p>위 결과를 통해 추정한 회귀 모형은 다음과 같다. <span class="math display">\[y = 54.1930 + 4.4339x_1-0.3934x_2\]</span> <span class="math display">\[(y=Sales, x_1 = Area, x_2 = Rooms)\]</span> 그러나, Rooms의 회귀계수는 t검정에 의한 p-value가 0.9492로 귀무가설을 기각하지 못한다. 그러므로, 독립변수 Rooms는 제외하는 편이 나을 것이라 예상할 수 있다.</p>
</section>
<section id="종속변수를-아파트-매매가격으로-하고-독립변수를-면적으로-한-단순회귀분석과-종속변수를-아파트-매매가격으로-하고-독립변수를-방의-수로-한-단순회귀분석을-실시하고-여기서-추정된-회귀계수의-의미에-대하여-설명하시오." class="level3">
<h3 class="anchored" data-anchor-id="종속변수를-아파트-매매가격으로-하고-독립변수를-면적으로-한-단순회귀분석과-종속변수를-아파트-매매가격으로-하고-독립변수를-방의-수로-한-단순회귀분석을-실시하고-여기서-추정된-회귀계수의-의미에-대하여-설명하시오.">(2) 종속변수를 아파트 매매가격으로 하고, 독립변수를 면적으로 한 단순회귀분석과 종속변수를 아파트 매매가격으로 하고, 독립변수를 방의 수로 한 단순회귀분석을 실시하고, 여기서 추정된 회귀계수의 의미에 대하여 설명하시오.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(Sales <span class="sc">~</span> Area, data1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ Area, data = data1)

Residuals:
    Min      1Q  Median      3Q     Max 
-44.911 -12.668   0.118  13.773  32.511 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  53.2303    14.1499   3.762  0.00096 ***
Area          4.4015     0.4183  10.522  1.8e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.52 on 24 degrees of freedom
Multiple R-squared:  0.8218,    Adjusted R-squared:  0.8144 
F-statistic: 110.7 on 1 and 24 DF,  p-value: 1.804e-10</code></pre>
</div>
</div>
<p>위 결과를 통해 추정한 회귀 모형은 다음과 같다. <span class="math display">\[y = 53.2303 + 4.4015x_1\]</span> <span class="math display">\[(y=Sales, x_1 = Area)\]</span></p>
<p>위 회귀 모형을 통해 면적과 매매가격에 양의 상관관계가 있음을 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(Sales <span class="sc">~</span> Rooms, data1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ Rooms, data = data1)

Residuals:
    Min      1Q  Median      3Q     Max 
-56.465 -23.754  -8.317  23.713  63.841 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    39.03      34.95   1.117 0.275057    
Rooms          30.91       6.72   4.599 0.000115 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 31.99 on 24 degrees of freedom
Multiple R-squared:  0.4684,    Adjusted R-squared:  0.4463 
F-statistic: 21.15 on 1 and 24 DF,  p-value: 0.0001152</code></pre>
</div>
</div>
<p>위 결과를 통해 추정한 회귀 모형은 다음과 같다. <span class="math display">\[y = 39.03 + 30.91x_2\]</span> <span class="math display">\[(y=Sales, x_2 = Rooms)\]</span></p>
<p>위 회귀모형을 통해 매매가격과 방의수 사이에는 양의 상관관계가 있음을 확인할 수 있다.</p>
<p>두 독립변수 모두 매매가격을 종속변수로 하여 각각 회귀분석을 했을 경우 회귀계수의 p-value가 매우 작은 수준으로 귀무가설을 기각한다. 때문에 두 회귀 계수 모두 통계적으로 유의하다.</p>
</section>
<section id="과-2의-회귀계수-결과가-다르게-나타나는-이유에-대하여-논의하시오." class="level3">
<h3 class="anchored" data-anchor-id="과-2의-회귀계수-결과가-다르게-나타나는-이유에-대하여-논의하시오.">(3) (1)과 (2)의 회귀계수 결과가 다르게 나타나는 이유에 대하여 논의하시오.</h3>
<p>(1)에서는 두 개의 독립변수를 사용하는 다중회귀분석을 진행하였다. 이때는 독립변수의 수가 두 개 이상이므로 다중공선성의 문제가 발생할 수 있다. 면적과 방의 수는 상관관계가 큰 독립변수이기 때문에 다중공선성의 문제가 발생한 것으로 보인다. 이로 인해, (1)에서 Rooms의 회귀계수가 예상과 다르게 음수가 나왔으며, 회귀 계수에 대한 t검정에 의한 p-value가 매우 높았던 것을 확인했다.</p>
<p>(2)에서는 두 개의 독립변수가 각각 매매가격과 단순회귀분석을 할 경우 통계적으로 유의한 회귀계수를 갖는다는 것을 볼 수 있다. 다만, Rooms 보단, Area가 훨씬 높은 adj -<span class="math inline">\(R^2\)</span> 를 보여주면서, 매매가격을 설명하는데 더 적합한 독립변수임을 알 수 있다.</p>
</section>
<section id="방의-수가-1개-증가하는-경우-면적이-평균적으로-얼마만큼-증가하는가" class="level3">
<h3 class="anchored" data-anchor-id="방의-수가-1개-증가하는-경우-면적이-평균적으로-얼마만큼-증가하는가">(4) 방의 수가 1개 증가하는 경우, 면적이 평균적으로 얼마만큼 증가하는가?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(Area <span class="sc">~</span> Rooms, data1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Area ~ Rooms, data = data1)

Residuals:
   Min     1Q Median     3Q    Max 
-8.937 -4.672  1.593  3.887 10.063 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -3.419      6.427  -0.532      0.6    
Rooms          7.059      1.236   5.712 6.95e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.883 on 24 degrees of freedom
Multiple R-squared:  0.5761,    Adjusted R-squared:  0.5585 
F-statistic: 32.62 on 1 and 24 DF,  p-value: 6.953e-06</code></pre>
</div>
</div>
<p>위 결과를 통해 추정한 회귀 모형은 다음과 같다. <span class="math display">\[x_1 = -3.419 + 7.059x_2\]</span> <span class="math display">\[(x_1=Area,x_2=Rooms)\]</span></p>
<p>방의 수가 1개 증가할 때 면적은 평균적으로 7.059 증가한다.</p>
</section>
<section id="동일한-면적의-아파트에서-다른-아파트보다-방의-수가-1개-많은-경우-매매가격이-어떻게-변하는지를-알아보고-이러한-차이를-방의-수에-따른-직접효과direct-effect라고-한다-방의-수가-1개-증가함으로서-아파트-면적이-증가하여-나타나는-매매가격의-변화이러한-차이를-방의-수에-따른-간접효과indirect-effect라고-한다에-대하여-설명하시오" class="level3">
<h3 class="anchored" data-anchor-id="동일한-면적의-아파트에서-다른-아파트보다-방의-수가-1개-많은-경우-매매가격이-어떻게-변하는지를-알아보고-이러한-차이를-방의-수에-따른-직접효과direct-effect라고-한다-방의-수가-1개-증가함으로서-아파트-면적이-증가하여-나타나는-매매가격의-변화이러한-차이를-방의-수에-따른-간접효과indirect-effect라고-한다에-대하여-설명하시오">(5) 동일한 면적의 아파트에서, 다른 아파트보다 방의 수가 1개 많은 경우, 매매가격이 어떻게 변하는지를 알아보고 (이러한 차이를 방의 수에 따른 직접효과(direct effect)라고 한다) 방의 수가 1개 증가함으로서 아파트 면적이 증가하여 나타나는 매매가격의 변화(이러한 차이를 방의 수에 따른 간접효과(indirect effect)라고 한다)에 대하여 설명하시오</h3>
<section id="동일한-면적-아파트에서-방의-수가-1개-많은-경우-매매가격이-어떻게-변하는지-알아보기직접효과" class="level4">
<h4 class="anchored" data-anchor-id="동일한-면적-아파트에서-방의-수가-1개-많은-경우-매매가격이-어떻게-변하는지-알아보기직접효과">(5-1) 동일한 면적 아파트에서 방의 수가 1개 많은 경우 매매가격이 어떻게 변하는지 알아보기(직접효과)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(data1<span class="sc">$</span>Area); <span class="fu">max</span>(data1<span class="sc">$</span>Area);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">16</span><span class="sc">:</span><span class="dv">54</span>) {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">sum</span>(data1<span class="sc">$</span>Area <span class="sc">==</span> i) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(i)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{}</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24
[1] 28
[1] 30
[1] 33
[1] 35</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data1_subset1 <span class="ot">=</span> data1[data1<span class="sc">$</span>Area <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">24</span>,<span class="dv">28</span>,<span class="dv">30</span>,<span class="dv">33</span>,<span class="dv">35</span>),<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>data1_subset1[<span class="fu">order</span>(data1_subset1<span class="sc">$</span>Area),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
    Area Rooms
   &lt;dbl&gt; &lt;dbl&gt;
 1    24     4
 2    24     4
 3    28     4
 4    28     5
 5    30     6
 6    30     6
 7    33     5
 8    33     6
 9    35     5
10    35     5
11    35     5</code></pre>
</div>
</div>
<p>28평, 33평 데이터로 면적이 같은 상태에서 방의 수에 따라 매매가격이 어떻게 변하는지 살펴볼 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data1_28A <span class="ot">=</span> data1[data1<span class="sc">$</span>Area <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">28</span>),]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>data1_33A <span class="ot">=</span> data1[data1<span class="sc">$</span>Area <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">33</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Sales<span class="sc">~</span>Rooms,data1_28A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ Rooms, data = data1_28A)

Coefficients:
(Intercept)        Rooms  
      243.3        -15.3  </code></pre>
</div>
</div>
<p>28평의 경우 Rooms의 회귀계수가 음수이다. 이는 방의 수가 늘어나면 매매가격이 떨어진다는 것을 의미한다.</p>
<p>그러나, 33평의 경우에는 반대 양상을 보인다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Sales<span class="sc">~</span>Rooms,data1_33A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ Rooms, data = data1_33A)

Coefficients:
(Intercept)        Rooms  
       93.6         16.8  </code></pre>
</div>
</div>
<p>그러나, 33평의 경우 Rooms의 회귀계수가 양수이다. 이는 방의 수가 늘어나면 매매가격이 높아진다는 것을 의미한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data1_33A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Sales   Dur  Area Rooms
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  178.   185    33     5
2  194.   174    33     6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>data1_28A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Sales   Dur  Area Rooms
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  182.   151    28     4
2  167.   125    28     5</code></pre>
</div>
</div>
<p>Duration에 의해 방의 수와 관계없이 매매가격이 변하였는지 확인해보았다. 하지만, 두 데이터에서 모두 방의수가 작은 경우 Duration이 길었으며, 33평은 Duration이 긴 경우에도 매매 가격이 작았기 때문에, Duration이 혼란변수로 작용했을 가능성은 낮다고 판단한다.</p>
<p>때문에, 위 결과를 미루어 보아 면적이 같을 때, 매매가격에 대해 방의 수가 끼치는 직접효과(direct effect)는 없는 것으로 추정할 수 있다. 이러한 결과는 데이터 수가 작기 때문에 나타났을 가능성이 커보인다.</p>
</section>
<section id="방의-수가-1개-증가함으로서-아파트-면적이-증가하여-나타나는-매매가격의-변화간접효과" class="level4">
<h4 class="anchored" data-anchor-id="방의-수가-1개-증가함으로서-아파트-면적이-증가하여-나타나는-매매가격의-변화간접효과">(5-1) 방의 수가 1개 증가함으로서 아파트 면적이 증가하여 나타나는 매매가격의 변화(간접효과)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(Sales<span class="sc">~</span>Area,data1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ Area, data = data1)

Residuals:
    Min      1Q  Median      3Q     Max 
-44.911 -12.668   0.118  13.773  32.511 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  53.2303    14.1499   3.762  0.00096 ***
Area          4.4015     0.4183  10.522  1.8e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.52 on 24 degrees of freedom
Multiple R-squared:  0.8218,    Adjusted R-squared:  0.8144 
F-statistic: 110.7 on 1 and 24 DF,  p-value: 1.804e-10</code></pre>
</div>
</div>
<p><span class="math display">\[y= 53.2303 + 4.4015x_1\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(Area<span class="sc">~</span>Rooms,data1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Area ~ Rooms, data = data1)

Residuals:
   Min     1Q Median     3Q    Max 
-8.937 -4.672  1.593  3.887 10.063 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -3.419      6.427  -0.532      0.6    
Rooms          7.059      1.236   5.712 6.95e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.883 on 24 degrees of freedom
Multiple R-squared:  0.5761,    Adjusted R-squared:  0.5585 
F-statistic: 32.62 on 1 and 24 DF,  p-value: 6.953e-06</code></pre>
</div>
</div>
<p><span class="math display">\[x_1= -3.419 + 7.059x_2\]</span></p>
<p>위 두 식을 연립하면 <span class="math display">\[y = 53.2283 + 4.4016(-3.419 + 7.059x_2)\]</span> <span class="math display">\[y=31.07089x_2 + (53.2283+4.4016*(-3.419))\]</span></p>
<p>그러므로, 방의수가 1 증가할 때마다, 매매가격은 31.07089 증가하는 간접효과를 보여주고 있다.</p>
</section>
</section>
<section id="앞에서-얻은-결과를-종합하여-방의-수가-1개-증가하게-되면-매매가격은-어떻게-변하는지를-아래-그림을-이용하여-설명하고-1-2-4에서-나타나는-회귀분석-결과에-대한-관계에-대하여-논의하시오." class="level3">
<h3 class="anchored" data-anchor-id="앞에서-얻은-결과를-종합하여-방의-수가-1개-증가하게-되면-매매가격은-어떻게-변하는지를-아래-그림을-이용하여-설명하고-1-2-4에서-나타나는-회귀분석-결과에-대한-관계에-대하여-논의하시오.">(6) 앞에서 얻은 결과를 종합하여, 방의 수가 1개 증가하게 되면, 매매가격은 어떻게 변하는지를 아래 그림을 이용하여 설명하고 (1), (2), (4)에서 나타나는 회귀분석 결과에 대한 관계에 대하여 논의하시오.</h3>
<pre><code>
    방의 수 (1개 증가) ---&gt; 면적 (7.059 증가)

       |                      |

       |                      |   ---&gt; 방의 수 1 증가당 매매가격 31.07089증가

       |                      |

      면적 --------------&gt;  면적 1 증가 당 매매가격 4.4016 증가
</code></pre>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>