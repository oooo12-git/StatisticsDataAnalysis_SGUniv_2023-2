<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="서강대학교 20121802 김재현">

<title>14th Week Assignment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="14th_Assignment_files/libs/clipboard/clipboard.min.js"></script>
<script src="14th_Assignment_files/libs/quarto-html/quarto.js"></script>
<script src="14th_Assignment_files/libs/quarto-html/popper.min.js"></script>
<script src="14th_Assignment_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="14th_Assignment_files/libs/quarto-html/anchor.min.js"></script>
<link href="14th_Assignment_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="14th_Assignment_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="14th_Assignment_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="14th_Assignment_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="14th_Assignment_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">14th Week Assignment</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>서강대학교 20121802 김재현 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="로지스틱-회귀분석이-확률을-이용하지-않고-로그오즈를-이용하여-확률을-표현하는-이유에-대하여-논의하시오." class="level2">
<h2 class="anchored" data-anchor-id="로지스틱-회귀분석이-확률을-이용하지-않고-로그오즈를-이용하여-확률을-표현하는-이유에-대하여-논의하시오.">1. 로지스틱 회귀분석이 확률을 이용하지 않고, 로그오즈를 이용하여 확률을 표현하는 이유에 대하여 논의하시오.</h2>
<p>회귀분석은 종속변수가 실수영역에 존재한다. 그러나 로지스틱 회귀분석의 종속변수인 확률은 0과 1 사이에만 존재한다. 오즈는 양수 영역에만 존재하며 그래프를 그려보면 대칭성도 없고 0.9 근처에서 급격히 숫자가 커지는 등 회귀분석에 적합하지 않다.</p>
<p>로그오즈는 양수와 음수 모두 존재하여 실수영역을 모두 커버한다. 또한 0을 기준으로 대칭을 이루는 그래프를 그린다. 그래프는 매우 부드러운 곡선을 갖고 있기 때문에 로그오즈가 회귀분석에 적합하여 로지스틱 회귀분석시 로그오즈를 이용하여 확률을 표현한다.</p>
<hr>
</section>
<section id="어느-자동차회사의-마케팅-부서에서는-로지스틱-회귀분석을-이용하여-자동차에-대한-구매의도를-파악할-수-있는지를-알아보기-위하여-33명의-소비자를-대상으로-예비조사를-실시하였다.-랜덤으로-선택된-33명의-소비자를-대상으로-연간-소득과-조사-당시-보유하고-있는-차의-보유기간을-조사하였다.-이러한-조사가-끝난-후-1년-뒤에-추적조사follow-up-study를-실시하여-신차의-구입여부를-조사하였더니-아래와-같은-결과가-나타났다." class="level2">
<h2 class="anchored" data-anchor-id="어느-자동차회사의-마케팅-부서에서는-로지스틱-회귀분석을-이용하여-자동차에-대한-구매의도를-파악할-수-있는지를-알아보기-위하여-33명의-소비자를-대상으로-예비조사를-실시하였다.-랜덤으로-선택된-33명의-소비자를-대상으로-연간-소득과-조사-당시-보유하고-있는-차의-보유기간을-조사하였다.-이러한-조사가-끝난-후-1년-뒤에-추적조사follow-up-study를-실시하여-신차의-구입여부를-조사하였더니-아래와-같은-결과가-나타났다.">2. 어느 자동차회사의 마케팅 부서에서는 로지스틱 회귀분석을 이용하여 자동차에 대한 구매의도를 파악할 수 있는지를 알아보기 위하여 33명의 소비자를 대상으로 예비조사를 실시하였다. 랜덤으로 선택된 33명의 소비자를 대상으로 연간 소득과 조사 당시 보유하고 있는 차의 보유기간을 조사하였다. 이러한 조사가 끝난 후, 1년 뒤에 추적조사(follow up study)를 실시하여 신차의 구입여부를 조사하였더니, 아래와 같은 결과가 나타났다.</h2>
<pre><code>소비자 id             1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17

구입여부 (1=구입)  0 0 1 0 0 1 1 1 0 1 1 0 0 1 0 0 1

연간소득 (백만원)  32 45 60 53 25 68 82 38 67 92 72 21 26 40 33 45 61

보유차량의 기간     3 2 2 1 4 1 2 5 2 2 3 5 3 4 3 1 2

소비자 id             18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33

구입여부 (1=구입)    0 1 0 0 1 1 0 0 1 0 0 1 0 0 1 0

연간소득 (백만원)   16 18 22 27 35 40 10 24 15 23 19 22 61 21 32 17

보유차량의 기간      3 4 6 3 3 3 4 3 4 3 5 2 2 3 5 1
</code></pre>
<section id="로지스틱-회귀분석을-실시하여-결과에-대하여-논의하시오." class="level3">
<h3 class="anchored" data-anchor-id="로지스틱-회귀분석을-실시하여-결과에-대하여-논의하시오.">(1) 로지스틱 회귀분석을 실시하여 결과에 대하여 논의하시오.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 불러오기 </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>구입 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>소득 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">45</span>, <span class="dv">60</span>, <span class="dv">53</span>, <span class="dv">25</span>, <span class="dv">68</span>, <span class="dv">82</span>, <span class="dv">38</span>, <span class="dv">67</span>, <span class="dv">92</span>, <span class="dv">72</span>, <span class="dv">21</span>, <span class="dv">26</span>, <span class="dv">40</span>, <span class="dv">33</span>, <span class="dv">45</span>, <span class="dv">61</span>, <span class="dv">16</span>, <span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">27</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="dv">24</span>, <span class="dv">15</span>, <span class="dv">23</span>, <span class="dv">19</span>, <span class="dv">22</span>, <span class="dv">61</span>, <span class="dv">21</span>, <span class="dv">32</span>, <span class="dv">17</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>기간 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 구입 변수는 factor로 변경</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>구입 <span class="ot">=</span> <span class="fu">as.factor</span>(구입)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 최대 우도 추정을 통해 최적의 로지스틱 회귀 모형 추정</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fullmodel <span class="ot">=</span> <span class="fu">glm</span>(구입 <span class="sc">~</span> 소득 <span class="sc">+</span> 기간 <span class="sc">+</span> 소득<span class="sc">*</span>기간, <span class="at">family=</span><span class="fu">binomial</span>())</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>nullmodel <span class="ot">=</span> <span class="fu">glm</span>(구입 <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family=</span><span class="fu">binomial</span>())</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>scope2 <span class="ot">=</span> <span class="fu">formula</span>(<span class="sc">~</span> 소득 <span class="sc">+</span> 기간 <span class="sc">+</span> 소득<span class="sc">*</span>기간)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model -&gt; null model로 가면서 최적 로지스틱 회귀모형 추정</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(fullmodel, <span class="at">direction=</span><span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=43.4
구입 ~ 소득 + 기간 + 소득 * 기간

            Df Deviance    AIC
- 소득:기간  1   36.690 42.690
&lt;none&gt;           35.404 43.404

Step:  AIC=42.69
구입 ~ 소득 + 기간

       Df Deviance    AIC
&lt;none&gt;      36.690 42.690
- 기간  1   39.305 43.305
- 소득  1   44.987 48.987</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = 구입 ~ 소득 + 기간, family = binomial())

Coefficients:
(Intercept)         소득         기간  
   -4.73931      0.06773      0.59863  

Degrees of Freedom: 32 Total (i.e. Null);  30 Residual
Null Deviance:      44.99 
Residual Deviance: 36.69    AIC: 42.69</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># null model에서 backward, forward 모두 사용하여 최적 모형 찾기</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(nullmodel, scope2, <span class="at">direction=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=46.99
구입 ~ 1

       Df Deviance    AIC
+ 소득  1   39.305 43.305
&lt;none&gt;      44.987 46.987
+ 기간  1   44.987 48.987

Step:  AIC=43.3
구입 ~ 소득

       Df Deviance    AIC
+ 기간  1   36.690 42.690
&lt;none&gt;      39.305 43.305
- 소득  1   44.987 46.987

Step:  AIC=42.69
구입 ~ 소득 + 기간

            Df Deviance    AIC
&lt;none&gt;           36.690 42.690
- 기간       1   39.305 43.305
+ 소득:기간  1   35.404 43.404
- 소득       1   44.987 48.987</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = 구입 ~ 소득 + 기간, family = binomial())

Coefficients:
(Intercept)         소득         기간  
   -4.73931      0.06773      0.59863  

Degrees of Freedom: 32 Total (i.e. Null);  30 Residual
Null Deviance:      44.99 
Residual Deviance: 36.69    AIC: 42.69</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># null model -&gt; full model로 가면서 최적 모형 찾기</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(nullmodel, scope2, <span class="at">direction=</span><span class="st">"forward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=46.99
구입 ~ 1

       Df Deviance    AIC
+ 소득  1   39.305 43.305
&lt;none&gt;      44.987 46.987
+ 기간  1   44.987 48.987

Step:  AIC=43.3
구입 ~ 소득

       Df Deviance    AIC
+ 기간  1   36.690 42.690
&lt;none&gt;      39.305 43.305

Step:  AIC=42.69
구입 ~ 소득 + 기간

            Df Deviance    AIC
&lt;none&gt;           36.690 42.690
+ 소득:기간  1   35.404 43.404</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = 구입 ~ 소득 + 기간, family = binomial())

Coefficients:
(Intercept)         소득         기간  
   -4.73931      0.06773      0.59863  

Degrees of Freedom: 32 Total (i.e. Null);  30 Residual
Null Deviance:      44.99 
Residual Deviance: 36.69    AIC: 42.69</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 최적 모형과 full model의 적합도 비교(카이제곱검정 분산분석)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> 구입 <span class="sc">~</span> 소득 <span class="sc">+</span> 기간, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M1, fullmodel, <span class="at">test=</span><span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: 구입 ~ 소득 + 기간
Model 2: 구입 ~ 소득 + 기간 + 소득 * 기간
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1        30     36.690                     
2        29     35.404  1   1.2855   0.2569</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>p-value가 0.2569로 최적모형과 full model의 차이인 상호작용항(소득*기간)이 통계적으로 유의하지 않다(유의수준 5% 기준)는 것을 보여준다.</p>
</div>
</div>
</section>
<section id="연간-5천만원의-소득이-있는-가정에서-현재-3년이-지난-차를-보유하고-있다면-다음-해에-자동차를-구입할-확률이-어떻게-되는지를-계산하시오." class="level3">
<h3 class="anchored" data-anchor-id="연간-5천만원의-소득이-있는-가정에서-현재-3년이-지난-차를-보유하고-있다면-다음-해에-자동차를-구입할-확률이-어떻게-되는지를-계산하시오.">(2) 연간 5천만원의 소득이 있는 가정에서 현재 3년이 지난 차를 보유하고 있다면, 다음 해에 자동차를 구입할 확률이 어떻게 되는지를 계산하시오.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 소득 50(백만원), 기간 3(년)일 때 다음해 신차 구입 확률 - predict</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M1, <span class="fu">list</span>(소득<span class="ot">=</span><span class="dv">50</span>, 기간 <span class="ot">=</span> <span class="dv">3</span>), <span class="at">type=</span><span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.6090245 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>약 60.9%의 확률로 다음해에 자동차를 구입할 것이다.</p>
</div>
</div>
</section>
<section id="어느-가정이-다른-가정과-비교하여-2천만원-소득이-높고-2년-오래된-차를-보유하고-있다면-신차를-구입할-오즈는-어떻게-변하며-확률은-어떻게-변하는지에-대하여-신뢰구간을-이용하여-설명하시오." class="level3">
<h3 class="anchored" data-anchor-id="어느-가정이-다른-가정과-비교하여-2천만원-소득이-높고-2년-오래된-차를-보유하고-있다면-신차를-구입할-오즈는-어떻게-변하며-확률은-어떻게-변하는지에-대하여-신뢰구간을-이용하여-설명하시오.">(3) 어느 가정이 다른 가정과 비교하여, 2천만원 소득이 높고, 2년 오래된 차를 보유하고 있다면, 신차를 구입할 오즈는 어떻게 변하며, 확률은 어떻게 변하는지에 대하여 신뢰구간을 이용하여 설명하시오.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 최적 모형 확인</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> 구입 <span class="sc">~</span> 소득 <span class="sc">+</span> 기간, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = 구입 ~ 소득 + 기간, family = binomial())

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept) -4.73931    2.10195  -2.255   0.0242 *
소득         0.06773    0.02806   2.414   0.0158 *
기간         0.59863    0.39007   1.535   0.1249  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 44.987  on 32  degrees of freedom
Residual deviance: 36.690  on 30  degrees of freedom
AIC: 42.69

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 최적모형의 coefficient를 이용하여 odds ratio 구하기</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(M1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        소득        기간 
0.008744682 1.070079093 1.819627221 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>소득이 백만원 증가할때 신차 구입 오즈는 약 1.07배가 된다. 자동차 보유 기간이 1년 증가할 때 마다 신차 구입 오즈는 약 1.82배가 된다.</p>
</div>
</div>
<p><strong>2천만원 소득이 높고, 2년 오래된 차를 보유하고 있다면</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2천만원 소득이 높고, 2년 오래된 차를 보유하는 경우의 odds ratio 계산</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>(<span class="fl">1.07</span>)<span class="sc">^</span><span class="dv">20</span><span class="sc">*</span>(<span class="fl">1.82</span>)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.81794</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>오즈는 12.81배 커진다.</p>
</div>
</div>
<p><strong>예를 들어, 연간 5천만원의 소득이 있는 가정에서 현재 3년이 지난 차를 보유하고 있는 가정이 신차를 구입할 확률은 0.6090245 이며 이에 대한 오즈는 아래와 같다.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 연간 5천만원의 소득이 있는 가정에서 현재 3년이 지난 차를 보유하고 있는 가정의 오즈 계산</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">=</span> <span class="fu">predict</span>(M1, <span class="fu">list</span>(소득<span class="ot">=</span><span class="dv">50</span>, 기간 <span class="ot">=</span> <span class="dv">3</span>), <span class="at">type=</span><span class="st">"link"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(logit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
1.557705 </code></pre>
</div>
</div>
<p><strong>그러므로, 비교 가정보다 2천만원 소득이 높고, 2년 오래된 차를 보유하고 있는(연 7천만원 소득, 5년이 지난 차를 보유하고 있는) 가정이 신차를 구매할 오즈는 아래와 같다.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 연 7천만원 소득, 5년이 지난 차를 보유하고 있는 가정의 오즈 계산</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fl">1.557705</span><span class="sc">*</span><span class="fl">12.81794</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.96657</code></pre>
</div>
</div>
<p><strong>이를 확률로 변환하면,</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 오즈를 확률로 변환</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fl">19.96657</span><span class="sc">/</span>(<span class="dv">1</span><span class="fl">+19.96657</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.952305</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>신차를 구입할 확률은 0.6090245 에서 0.952305으로 증가했다.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 소득과 기간의 오즈 신뢰구간 확인 </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(M1, <span class="fu">c</span>(<span class="st">"소득"</span>,<span class="st">"기간"</span>))) <span class="co"># Approximation of 95% CI for Odds Ratio </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        2.5 %   97.5 %
소득 1.019694 1.140854
기간 0.884999 4.250058</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>신뢰구간을 확인해보면 소득의 오즈의 신뢰구간은 1을 포함하고 있지 않기 때문에, 소득수준에 따라 신차를 구매할 확률에 확실히 차이가 있다고 볼 수 있다.</p>
<p>그러나, 기간의 오즈의 신뢰구간은 1을 포함하고 있으므로, 기간이 신차 구매 확률에 끼치는 영향은 있을 수도 있고, 없을 수도 있다</p>
</div>
</div>
</section>
<section id="보유차량-기간을-독립변수로-포함시킨-로지스틱-회귀모형과-포함시키지-않은-회귀모형을-비교하여-분석하고-결과에-대하여-논의하시오." class="level3">
<h3 class="anchored" data-anchor-id="보유차량-기간을-독립변수로-포함시킨-로지스틱-회귀모형과-포함시키지-않은-회귀모형을-비교하여-분석하고-결과에-대하여-논의하시오.">(4) 보유차량 기간을 독립변수로 포함시킨 로지스틱 회귀모형과 포함시키지 않은 회귀모형을 비교하여 분석하고, 결과에 대하여 논의하시오.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 기간을 독립변수로 포함시킨 로지스틱 회귀모형과 제외한 모형의 적합도 비교(카이제곱검정 분산분석)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> 구입 <span class="sc">~</span> 소득 <span class="sc">+</span> 기간, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>M1_updated <span class="ot">=</span> <span class="fu">update</span>(M1, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">-</span> 기간) <span class="co"># 기존 모델 M1에서 '기간' 변수를 제거</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M1_updated, M1, <span class="at">test=</span><span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: 구입 ~ 소득
Model 2: 구입 ~ 소득 + 기간
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1        31     39.305                     
2        30     36.690  1   2.6149   0.1059</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>p-value가 0.1059로 기간항이 통계적으로 유의하지 않다(유의수준 5% 기준)는 것을 보여준다.</p>
</div>
</div>
</section>
<section id="연간소득과-보유차량의-기간-사이에-존재할-수-있는-상호작용효과는-어떠한-의미를-갖는지에-대하여-설명하시오." class="level3">
<h3 class="anchored" data-anchor-id="연간소득과-보유차량의-기간-사이에-존재할-수-있는-상호작용효과는-어떠한-의미를-갖는지에-대하여-설명하시오.">(5) 연간소득과 보유차량의 기간 사이에 존재할 수 있는 상호작용효과는 어떠한 의미를 갖는지에 대하여 설명하시오.</h3>
<p><strong>연간소득이 많지만 보유 차량의 기간이 긴 경우, 해당 가구는 절약하는 경향이 있다고 볼 수 있다.</strong> 이러한 가구는 신차가 아닌 중고차를 구매할 가능성이 더 커보인다. 때문에 연간소득이 많으면서 보유 차량의 기간이 길면, 차를 바꿀 수 있을 만큼 소득이 충분하고 차를 바꿀 동기가 충분하기 때문에 신차를 구매할 확률이 매우 높아야 하지만, 절약하는 경향이 있는 가구들이 데이터에 포함되어 연간소득이 많고 보유 차량의 기간이 길지만 신차를 구매할 확률을 낮춘다. 이러한 상호작용으로 인해 기간 독립변수가 신차를 구매할 확률에 미치는 영향이 통계적으로 유의하지 않게 나타나는 것으로 추측한다.</p>
</section>
<section id="신차의-구입여부를-예측하기-위하여-어떠한-다른-독립변수가-사용될-수-있는지에-대하여-논의하시오." class="level3">
<h3 class="anchored" data-anchor-id="신차의-구입여부를-예측하기-위하여-어떠한-다른-독립변수가-사용될-수-있는지에-대하여-논의하시오.">(6) 신차의 구입여부를 예측하기 위하여, 어떠한 다른 독립변수가 사용될 수 있는지에 대하여 논의하시오.</h3>
<p><strong>소득, 차량 보유기간과 더불어, 이전까지 신차를 구매했던 이력(수)를 독립변수로 사용하면 신차를 구매할 확률을 예측하는데에 도움을 줄 것이라 생각한다.</strong> 앞서 (5)에서 밝힌바와 같이 절약하는 가구는 신차를 구매하지 않고 중고차를 구매하는 경향이 있을 것이라 예상한다. 때문에, 신차를 구매했던 이력(수) 독립변수가 있다면, 신차 대신 중고차를 구매하는 가구를 분리할 수 있을 것으로 생각한다.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>