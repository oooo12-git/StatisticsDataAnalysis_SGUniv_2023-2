---
title: 'ch20 Hypothesis Test'
author: '서강대학교 20121802 김재현'
date: "2023-11-02"
format: html
toc: True
---

# 20장에 나오는 R코드를 이용하여 실습한 내용 제출하기.

## [예제1] 가설의 설정

과자봉지에 **400g의 내용물이 표시**되어 있는데, 최근 과자의 양이 적어졌다고 불평하는 소비자들이 많아졌다. 이를 확인하기 위하여 **해당 회사**는 과자봉지에 대한 내용물 무게를 조사하여 일부 소비자가 재기한 불평에 대한 근거가 있는지를 판단하고자 한다. 이 문제에 대하여 귀무가설과 대립가설을 어떻게 설정할 것인지에 대하여 논의하시오

### 기각역에 대한 이해

[**[그림 10-1] 272p**]{style="color:blue"}

제1형 대립가설(양측검정)에 대한 기각역

```{r}
x=seq(-4,4,0.01); y=dnorm(x); x1=qnorm(0.025); x2=qnorm(0.975)
plot(x, y, xlab='', type='l', ylab='', lwd=2, main='') 
polygon(c(x2,x[(x>x2)]), c(0,y[(x>x2)]), col="gray")
polygon(c(x[(x<x1)],x1), c(y[(x<x1)],0), col="gray")
```

제2형 대립가설(우측검정)에 대한 기각역

```{r}
x2=qnorm(0.95)
plot(x, y, xlab='', type='l', ylab='', lwd=2, main='') 
polygon(c(x2,x[(x>x2)]), c(0,y[(x>x2)]), col="gray")
```

제3형 대립가설(좌측검정)에 대한 기각역

```{r}
x1=qnorm(0.05)
plot(x, y, xlab='', type='l', ylab='', lwd=2, main='') 
polygon(c(x[(x<x1)],x1), c(y[(x<x1)],0), col="gray")
```

### 기각역 설정

#### [**1번 case**]{style="color:red"}

1.  표본평균을 검정 통계량으로 사용\
2.  좌측검정\
3.  유의수준 5%\
4.  평균 170\
5.  표준오차 10/sqrt(25)\
    인 경우 기각역

```{r}
qnorm(0.05, 170, 10/sqrt(25))
```

#### [**2번 case**]{style="color:red"}

1.  Z값을 검정통계량으로 사용\
2.  좌측검정\
3.  유의수준 5%\
4.  평균 0, 표준편차 1\
    인 경우 기각역

```{r}
qnorm(0.05)
```

### p값 계산

1.  표본평균을 검정 통계량으로 사용\
2.  검정통계량 = 166\
3.  평균 170\
4.  표준오차 10/sqrt(25)\

```{r}
pnorm(166, 170, 10/sqrt(25))
```

### p값의 종류

[**[그림 10-1] 276p**]{style="color:blue"}

```{r}
par(family="AppleGothic")

x=seq(162,178,0.01); y=dnorm(x, 170, 2); x1=166; x2=174; 
plot(x, y, xlab='', type='l', ylab='', lwd=2, 
     main='p값 확률에 대한 계산: 제1형 대립가설의 경우')
polygon(c(x2,x[(x>x2)]), c(0,y[(x>x2)]), col="gray")
polygon(c(x[(x<x1)],x1), c(y[(x<x1)],0), col="gray")
```

```{r}
par(family="AppleGothic")

plot(x, y, xlab='', type='l', ylab='', lwd=2, main='p값 확률에 대한 계산: 제2형 대립가설의 경우') 
polygon(c(x2,x[(x>x2)]), c(0,y[(x>x2)]), col="gray")
```

```{r}
par(family="AppleGothic")

plot(x, y, xlab='', type='l', ylab='', lwd=2, main='p값 확률에 대한 계산: 제3형 대립가설의 경우') 
polygon(c(x[(x<x1)],x1), c(y[(x<x1)],0), col="gray")
```

------------------------------------------------------------------------

## [예제2] 모평균검정 (표본크기 작은 경우)

A 회사는 자신들이 출시한 건강음료가 **평균 7.7ml** 비타민C 원액을 포함하고 있다고 광고하였다. 하지만 소비자 단체에서는 비타민C 원액이 **함량미달이므로 과대광고를 조사해 달라는 요청**이 들어왔다.

공정거래위원회는 이러한 소비자 단체의 주장이 타당한지를 확인하기 위하여 **10개 제품을 수집**하여 조사한 결과 **표본평균 7.548ml, 표본표준편차는 0.21ml**로 나타났다. 이에 대한 자료는 다음과 같다.

7.35, 7.39, 7.87, 7.41, 7.42, 7.69, 7.82, 7.75, 7.32, 7.46

소비자 단체의 주장에 대하여 **유의수준 5%**에서 가설검정을 진행하여라.

### t-검정

**표본크기가 작은 경우**에 대한 모평균검정에 사용\
모분산, 모표준편차를 모르는 경우

```{r}
x = c(7.35, 7.39, 7.87, 7.41, 7.42, 7.69, 7.82, 7.75, 7.32, 7.46)
t.test(x, alternative="less",mu=7.7)
```

p값은 0.02405 유의수준 5%에서 기각할 수 있다.

------------------------------------------------------------------------

## [예제3] 모평균검정(표본크기 큰 경우)

**표본크기가 큰 경우**에 대한 모평균 검정

우리나라 중학교 1학년 학생의 **평균키는 159cm**로 알려져 있다. 서울지역의 중학교 1학년 학생 **50명** 을 대상으로 조사한 결과 **표본평균은 160cm, 표본분산은 6cm**으로 나타났다. 서울지역 중학교 1학년 학생의 평균키와 우리나라 중학교 1학년 학생의 **평균키 차이가 있는지** 가설검정을 진행하여라.

(5% 유의수준 설정)

H0 : mu = 159\
(mu = 중학교 1학년 학생의 평균키)\
H1 : mu $\neq$ 159 \> 제1형 대립가설

### Z검정 - 정규분포 근사

```{r}
2*(1-pnorm(160,159,sqrt(6/50)))
```

p값이 유의수준(5%)이하이기 때문에 귀무가설을 기각할 수 있다.

------------------------------------------------------------------------

## [예제 7] 대응표본에 대한 가설검정

**대응표본 t-검정(paired- t-test)**

대응표본 (paired sample) = 한 사람을 반복적으로 두 번 측정하여 나온 데이터 = 반복측정설계(repeated measure design)의 가장 간단한 형태 한 사람을 반복적으로 측정했기 때문에 두 데이터는 **상관관계**가 있다.

귀무가설 H0 : 대응 표본 차이(표본 처리 전후 차이) = 0 대립가설 H1 : 대응 표본 차이 \>0 or \<0 or \$neq\$0

![](https://i.ibb.co/ZmBQvBZ/Screenshot-2023-11-02-at-10-36-14-AM.png)

다이어트 효과에 대해서 관심 있는 건 mu \> 0 인 경우일 것이다.\
다이어트 이후 몸무게가 줄어드는 것에만 관심있기 때문.\
(다이어트 이전 몸무게 - 이후 몸무게 \> 0)

때문에 우측검정을 한다.

```{r}
x = c(81, 72, 90, 87, 110, 102, 66, 73, 83, 84) 
y = c(78, 72, 85, 84, 101, 101, 60, 68, 80, 79) 
t.test(x, y, paired=TRUE, alternative="greater")
```

유의 수준 5%로 설정할 경우 p값이 0.042%로 매우 작기 때문에, 귀무가설을 기각한다. 즉, 다이어트에 의한 효과가 존재한다.

### **t.test 함수 활용**

paired t-test를 하려면...\
**인수 : paired = True**

우측검정(제 2형 대립가설) 이라면...\
**인수 : alternative="greater"**

------------------------------------------------------------------------

## [예제 8] 독립된 두 모집단 가설 검정

다음은 뉴욕증권거래소(NYSE; New York Stock Exchange)에서 거래되고 있는 대표적인 24개 컴퓨터관련 기업과 17개 건설 관련 기업에 대한 자기자본이익률(ROE; Return On Equity) 데이터이다. 두 산업에 대한 **자기자본이익률 평균**에 대한 **차이가 있는지**를 *분산이 같다는 가정*하에,**유의수준 1%**에서 검정하시오.

컴퓨터 관련 산업에 대한 24개 기업 ROE (단위 : %) 22.4 32.4 21.2 36.8 42.2 16.4 15.5 38.8 24.9 26.6 28.5 25.0 21.8 26.5 10.1 14.1 12.5 14.6 30.5 13.0 41.3 40.4 25.5 35.8

건설 관련 산업에 대한 17개 기업 ROE (단위 : %)\
15.7 14.1 12.3 12.1 14.7 10.3 14.3 21.4 15.0 40.8 11.5 13.7 16.9 11.0 8.7 11.8 8.2 8.7 11.8 8.2

(참고: 컴퓨터 산업의 ROE 표본평균은 25.7. 표본분산은 99.15, 건설산업의 ROE 표본평균은 14.853, 표본분산은 54.7264 이다.)

### 독립된 두 모집단

독립된 두 모집단은 대응 표본 혹은 반복측정설계와는 다르게, **독립 그룹 설계(independent group design)**으로 분석을 진행할 때 볼 수 있다.

**독립된 두 모집단에선 한 사람을 반복적으로 측정하지 않는다.**

즉, 한쪽 그룹은 처리그룹이 되고, 한쪽 그룹은 대조그룹이 되어, 처리효과를 파악하는 실험설계를 의미한다.

### [[!중요!]등분산성의 가정]{style="color:red"}

**F검정, T검정 모두 등분산성(두 데이터의 분산이 같다.)라는 가정하에 이뤄진다.**

두 모집단 가설을 검정할 경우 T검정, F검정을 통해 가설검정을 해야하는데, 만약, 등분산성을 만족하지 않는 상황이라면, *두 분산을 같게 만들어줘야 한다.*

두 모집단이 등분산성을 같도록 하기 위해 주로, **변수변환**을 하게 된다.

변수변환 방법으로는 주로, log 변환 혹은 sqrt(sqare root)변환을 사용한다.

```{r}
x = c(22.4, 32.4, 21.2, 36.8, 42.2, 16.4, 15.5, 38.8, 24.9, 26.6, 28.5, 25.0, 21.8, 26.5, 10.1, 14.1, 12.5, 14.6, 30.5, 13.0, 41.3, 40.4, 25.5, 35.8) 
y = c(15.7, 14.1, 12.3, 12.1, 14.7, 10.3, 14.3, 21.4, 15.0, 40.8, 11.5, 13.7, 16.9, 11.0, 8.7, 11.8, 8.2) 
t.test(x, y, alternative="two.sided", var.equal=TRUE, conf.level=0.99)
```

### **t.test 함수 활용**

'차이가 있는지를 확인'하는 경우이기 때문에 양측검정을 한다.\
**인수 : alternative="two.sided"**

등분산성을 만족한다는 가정을 하려면...\
**인수 : var.equal=TRUE**

유의수준 1%라면...\
1-신뢰수준 = 유의수준\
신뢰수준 = 0.99(99%)\
**인수 : conf.level=0.99**

------------------------------------------------------------------------
