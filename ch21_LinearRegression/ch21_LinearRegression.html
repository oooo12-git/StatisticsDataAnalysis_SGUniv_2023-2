<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="서강대학교 20121802 김재현">

<title>ch21 Linear Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="ch21_LinearRegression_files/libs/clipboard/clipboard.min.js"></script>
<script src="ch21_LinearRegression_files/libs/quarto-html/quarto.js"></script>
<script src="ch21_LinearRegression_files/libs/quarto-html/popper.min.js"></script>
<script src="ch21_LinearRegression_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ch21_LinearRegression_files/libs/quarto-html/anchor.min.js"></script>
<link href="ch21_LinearRegression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ch21_LinearRegression_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ch21_LinearRegression_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ch21_LinearRegression_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ch21_LinearRegression_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#예제1-회귀모형을-통한-종속변수-y값-생성" id="toc-예제1-회귀모형을-통한-종속변수-y값-생성" class="nav-link active" data-scroll-target="#예제1-회귀모형을-통한-종속변수-y값-생성">1. [예제1] 회귀모형을 통한 종속변수 Y값 생성</a></li>
  <li><a href="#예제2-최소제곱법으로-회귀모형-추정" id="toc-예제2-최소제곱법으로-회귀모형-추정" class="nav-link" data-scroll-target="#예제2-최소제곱법으로-회귀모형-추정">2. [예제2] 최소제곱법으로 회귀모형 추정</a></li>
  <li><a href="#예제3-분산분석표" id="toc-예제3-분산분석표" class="nav-link" data-scroll-target="#예제3-분산분석표">3. [예제3] 분산분석표</a></li>
  <li><a href="#예제4-회귀계수-중-기울기-beta에-대한-추정량-b" id="toc-예제4-회귀계수-중-기울기-beta에-대한-추정량-b" class="nav-link" data-scroll-target="#예제4-회귀계수-중-기울기-beta에-대한-추정량-b">4. [예제4] 회귀계수 중 기울기 <span class="math inline">\(\beta\)</span>에 대한 추정량 b</a>
  <ul class="collapse">
  <li><a href="#성질5에-나타난-통계량" id="toc-성질5에-나타난-통계량" class="nav-link" data-scroll-target="#성질5에-나타난-통계량">(성질5)에 나타난 통계량</a></li>
  <li><a href="#r에서-확인하는-방법" id="toc-r에서-확인하는-방법" class="nav-link" data-scroll-target="#r에서-확인하는-방법">R에서 확인하는 방법</a></li>
  </ul></li>
  <li><a href="#예제5-절편항-alpha에-대한-추정량-a" id="toc-예제5-절편항-alpha에-대한-추정량-a" class="nav-link" data-scroll-target="#예제5-절편항-alpha에-대한-추정량-a">5. [예제5] 절편항 <span class="math inline">\(\alpha\)</span>에 대한 추정량 a</a>
  <ul class="collapse">
  <li><a href="#성질6에-나타난-통계량" id="toc-성질6에-나타난-통계량" class="nav-link" data-scroll-target="#성질6에-나타난-통계량">(성질6)에 나타난 통계량</a></li>
  <li><a href="#r에서-확인하는-방법-1" id="toc-r에서-확인하는-방법-1" class="nav-link" data-scroll-target="#r에서-확인하는-방법-1">R에서 확인하는 방법</a></li>
  </ul></li>
  <li><a href="#예제6-ey와-y의-신뢰구간-차이" id="toc-예제6-ey와-y의-신뢰구간-차이" class="nav-link" data-scroll-target="#예제6-ey와-y의-신뢰구간-차이">6. [예제6] E(Y)와 Y의 신뢰구간 차이</a></li>
  <li><a href="#예제7-ey와-y의-신뢰구간-차이-이해하기" id="toc-예제7-ey와-y의-신뢰구간-차이-이해하기" class="nav-link" data-scroll-target="#예제7-ey와-y의-신뢰구간-차이-이해하기">7. [예제7] E(Y)와 Y의 신뢰구간 차이 이해하기</a>
  <ul class="collapse">
  <li><a href="#성질7에-나타난-통계량" id="toc-성질7에-나타난-통계량" class="nav-link" data-scroll-target="#성질7에-나타난-통계량">(성질7)에 나타난 통계량</a></li>
  <li><a href="#predict를-이용하여-r에서-확인하는-방법" id="toc-predict를-이용하여-r에서-확인하는-방법" class="nav-link" data-scroll-target="#predict를-이용하여-r에서-확인하는-방법">predict()를 이용하여 R에서 확인하는 방법</a></li>
  </ul></li>
  <li><a href="#잔차분석회귀진단-실습" id="toc-잔차분석회귀진단-실습" class="nav-link" data-scroll-target="#잔차분석회귀진단-실습">8. 잔차분석(회귀진단) 실습</a>
  <ul class="collapse">
  <li><a href="#데이터준비" id="toc-데이터준비" class="nav-link" data-scroll-target="#데이터준비">1) 데이터준비</a></li>
  <li><a href="#회귀분석" id="toc-회귀분석" class="nav-link" data-scroll-target="#회귀분석">2) 회귀분석</a></li>
  <li><a href="#잔차분석-gvlma" id="toc-잔차분석-gvlma" class="nav-link" data-scroll-target="#잔차분석-gvlma">3) 잔차분석 gvlma()</a></li>
  <li><a href="#산점도---면적에-따른-아파트-매매가격-잔차와-예측값" id="toc-산점도---면적에-따른-아파트-매매가격-잔차와-예측값" class="nav-link" data-scroll-target="#산점도---면적에-따른-아파트-매매가격-잔차와-예측값">4) 산점도 - 면적에 따른 아파트 매매가격 / 잔차와 예측값</a></li>
  <li><a href="#극단값-레버리지-dffits통계량-cooks-d-통계량" id="toc-극단값-레버리지-dffits통계량-cooks-d-통계량" class="nav-link" data-scroll-target="#극단값-레버리지-dffits통계량-cooks-d-통계량">5) 극단값, 레버리지, DFFITS통계량, Cooks’ D 통계량</a></li>
  <li><a href="#영향점-제거-후-회귀분석" id="toc-영향점-제거-후-회귀분석" class="nav-link" data-scroll-target="#영향점-제거-후-회귀분석">6) 영향점 제거 후 회귀분석</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ch21 Linear Regression</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>서강대학교 20121802 김재현 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="예제1-회귀모형을-통한-종속변수-y값-생성" class="level2">
<h2 class="anchored" data-anchor-id="예제1-회귀모형을-통한-종속변수-y값-생성">1. [예제1] 회귀모형을 통한 종속변수 Y값 생성</h2>
<p><img src="./images/no1-1.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">signif</span>(y,<span class="dv">3</span>) <span class="co">#signif는 유효숫자를 정해준다. 여기서는 유효숫자를 3자리로 정한다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.11 4.60 6.47</code></pre>
</div>
</div>
<hr>
</section>
<section id="예제2-최소제곱법으로-회귀모형-추정" class="level2">
<h2 class="anchored" data-anchor-id="예제2-최소제곱법으로-회귀모형-추정">2. [예제2] 최소제곱법으로 회귀모형 추정</h2>
<p><img src="./images/no1-2.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">c</span>(<span class="fl">2.69</span>,<span class="fl">4.38</span>,<span class="fl">8.13</span>) <span class="co">#주어진 데이터세트와 같도록 y 변경</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y<span class="sc">~</span>x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x)

Coefficients:
(Intercept)            x  
    -0.3733       2.7200  </code></pre>
</div>
</div>
<p>(Intercept) = <span class="math inline">\(\alpha\)</span>의 추정량 a<br>
x = <span class="math inline">\(\beta\)</span>의 추정량 b</p>
<hr>
</section>
<section id="예제3-분산분석표" class="level2">
<h2 class="anchored" data-anchor-id="예제3-분산분석표">3. [예제3] 분산분석표</h2>
<p><img src="./images/no1-3.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: y
          Df  Sum Sq Mean Sq F value Pr(&gt;F)
x          1 14.7968 14.7968  20.921  0.137
Residuals  1  0.7073  0.7073               </code></pre>
</div>
</div>
<p>SSR = 14.7968, MSR = 14.7968(SSR을 자유도로 나눠준 값)<br>
SSE = 0.7073, MSE = 0.7073(SSE를 자유도로 나눠준 값)<br>
F-value = MSR/MSE ~ F(1,n-2)의 분포</p>
<p><strong>p값 = 0.137</strong><br>
굉장히 큰 p값을 갖고있다. 이는 귀무가설 Ho(<span class="math inline">\(\beta = 0\)</span>)을 기각하지 못한다는 의미이다. 즉, x가 y에 영향을 미치지 못하는 것이다.</p>
<p>왜냐하면, 데이터 수가 작기 때문이다. 데이터가 충분하지 않다면 귀무가설을 기각하지 못하도록 가설검정은 귀무가설에 선호도를 두고 있다.</p>
<hr>
</section>
<section id="예제4-회귀계수-중-기울기-beta에-대한-추정량-b" class="level2">
<h2 class="anchored" data-anchor-id="예제4-회귀계수-중-기울기-beta에-대한-추정량-b">4. [예제4] 회귀계수 중 기울기 <span class="math inline">\(\beta\)</span>에 대한 추정량 b</h2>
<p><img src="./images/no1-4.png" class="img-fluid"></p>
<section id="성질5에-나타난-통계량" class="level3">
<h3 class="anchored" data-anchor-id="성질5에-나타난-통계량">(성질5)에 나타난 통계량</h3>
<ol type="1">
<li><span class="math inline">\(\beta\)</span>에 대한 추정량 b의 분산 &amp; 표준오차에 대한 불편추정량</li>
<li>가설검정을 위한(H0: <span class="math inline">\(\beta=0\)</span>, H1: <span class="math inline">\(\beta\neq0\)</span>) 검정통계량</li>
</ol>
<section id="beta에-대한-추정량-b의-분산-표준오차에-대한-불편추정량" class="level4">
<h4 class="anchored" data-anchor-id="beta에-대한-추정량-b의-분산-표준오차에-대한-불편추정량">1) <span class="math inline">\(\beta\)</span>에 대한 추정량 b의 분산 &amp; 표준오차에 대한 불편추정량</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># b의 분산의 불편추정량 = MSE/sigma(x-xbar)^2</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MSE = 0.707</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sigma(x-xbar)^2 = 2</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Varb <span class="ot">=</span> <span class="fl">0.707</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>Varb <span class="co"># $\beta$에 대한 추정량 b의 분산에 대한 추정량</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3535</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>SEb <span class="ot">=</span> <span class="fu">sqrt</span>(Varb)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>SEb <span class="co"># $\beta$에 대한 추정량 b의 표준오차에 대한 추정량</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5945587</code></pre>
</div>
</div>
</section>
<section id="가설검정을-위한h0-beta0-h1-betaneq0-검정통계량" class="level4">
<h4 class="anchored" data-anchor-id="가설검정을-위한h0-beta0-h1-betaneq0-검정통계량">2) 가설검정을 위한(H0: <span class="math inline">\(\beta=0\)</span>, H1: <span class="math inline">\(\beta\neq0\)</span>) 검정통계량</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 검정통계량 t = b/sigmahat(b) ~ t(n-2)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sigmahat(b) = $\beta$에 대한 추정량 b의 표준오차에 대한 추정량</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fl">2.72</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sigmahat(b) = SEb</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> b<span class="sc">/</span>SEb</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.574822</code></pre>
</div>
</div>
<section id="검정통계량을-이용하여-p-value-계산" class="level5">
<h5 class="anchored" data-anchor-id="검정통계량을-이용하여-p-value-계산">검정통계량을 이용하여 p-value 계산</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(t,<span class="dv">1</span>)) <span class="co">#양측검정</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1370024</code></pre>
</div>
</div>
<p>위에서 구한 분산분석표와 동일한 p값을 보여준다.</p>
</section>
</section>
<section id="신뢰수준에서-신뢰구간-계산" class="level4">
<h4 class="anchored" data-anchor-id="신뢰수준에서-신뢰구간-계산">3) 88% 신뢰수준에서 신뢰구간 계산</h4>
<p>유의수준<span class="math inline">\(\alpha\)</span>를 구해보자, <span class="math inline">\(신뢰수준= 1 - \alpha\)</span> 이므로 <span class="math inline">\(\alpha = 1-0.88 = 0.12\)</span></p>
<p><img src="./images/no1-5.png" class="img-fluid"> 위 식(왼쪽식)을 이용하여 신뢰구간을 구하면</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>b <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="fl">-0.06</span>,<span class="dv">1</span>)<span class="sc">*</span>SEb <span class="co">#양쪽 검정이므로 alpha/2 = 0.06 이용</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.836786</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>b <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="fl">-0.06</span>,<span class="dv">1</span>)<span class="sc">*</span>SEb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3967856</code></pre>
</div>
</div>
</section>
</section>
<section id="r에서-확인하는-방법" class="level3">
<h3 class="anchored" data-anchor-id="r에서-확인하는-방법">R에서 확인하는 방법</h3>
<p>이를 R에서 회귀분석 객체에 대한 <code>summary()</code>를 보고 파악할 수 있다.</p>
<section id="회귀분석-lm의-summary" class="level4">
<h4 class="anchored" data-anchor-id="회귀분석-lm의-summary">1) 회귀분석 lm()의 summary()</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">=</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x)

Residuals:
      1       2       3 
 0.3433 -0.6867  0.3433 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  -0.3733     1.2846  -0.291    0.820
x             2.7200     0.5947   4.574    0.137

Residual standard error: 0.841 on 1 degrees of freedom
Multiple R-squared:  0.9544,    Adjusted R-squared:  0.9088 
F-statistic: 20.92 on 1 and 1 DF,  p-value: 0.137</code></pre>
</div>
</div>
<p><code>Coefficients</code>에서 x행에 <span class="math inline">\(\beta\)</span>에 대한 추정값 b, b의 표준오차에 대한 추정값, b의 검정통계량, 검정통계량에 의한 p값을 확인할 수 있다.</p>
</section>
<section id="confint로-신뢰구간-확인하기" class="level4">
<h4 class="anchored" data-anchor-id="confint로-신뢰구간-확인하기">2) confint()로 신뢰구간 확인하기</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M1,<span class="at">parm =</span> <span class="st">'x'</span>,<span class="at">level=</span><span class="fl">0.88</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         6 %     94 %
x -0.3973734 5.837373</code></pre>
</div>
</div>
<p>x행에서 신뢰수준 88%일때 <span class="math inline">\(\beta\)</span>에 대한 추정량 b의 신뢰구간을 확인할 수 있다.</p>
<hr>
</section>
</section>
</section>
<section id="예제5-절편항-alpha에-대한-추정량-a" class="level2">
<h2 class="anchored" data-anchor-id="예제5-절편항-alpha에-대한-추정량-a">5. [예제5] 절편항 <span class="math inline">\(\alpha\)</span>에 대한 추정량 a</h2>
<p><img src="./images/no1-6.png" class="img-fluid"></p>
<section id="성질6에-나타난-통계량" class="level3">
<h3 class="anchored" data-anchor-id="성질6에-나타난-통계량">(성질6)에 나타난 통계량</h3>
<ol type="1">
<li><span class="math inline">\(\alpha\)</span>에 대한 추정량 a의 분산 &amp; 표준오차에 대한 불편추정량</li>
<li>가설검정을 위한(H0: <span class="math inline">\(\alpha=0\)</span>, H1: <span class="math inline">\(\alpha\neq0\)</span>) 검정통계량</li>
</ol>
<section id="alpha에-대한-추정량-a의-분산-표준오차에-대한-불편추정량" class="level4">
<h4 class="anchored" data-anchor-id="alpha에-대한-추정량-a의-분산-표준오차에-대한-불편추정량">1) <span class="math inline">\(\alpha\)</span>에 대한 추정량 a의 분산 &amp; 표준오차에 대한 불편추정량</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># n = 데이터의 갯수 = 3</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a의 분산의 불편추정량 =  (1/n + xbar^2/sigma(x-xbar)^2)*MSE</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># MSE = 0.707</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sigma(x-xbar)^2 = 2</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># xbar = 2</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>VARa <span class="ot">=</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fl">0.707</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>VARa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.649667</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>SEa <span class="ot">=</span> <span class="fu">sqrt</span>(VARa)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>SEa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.284394</code></pre>
</div>
</div>
</section>
<section id="가설검정을-위한h0-alpha0-h1-alphaneq0-검정통계량" class="level4">
<h4 class="anchored" data-anchor-id="가설검정을-위한h0-alpha0-h1-alphaneq0-검정통계량">2) 가설검정을 위한(H0: <span class="math inline">\(\alpha=0\)</span>, H1: <span class="math inline">\(\alpha\neq0\)</span>) 검정통계량</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 검정통계량 tA = a/sigmahat(a) ~ t(n-2)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#sigmahat(a) = a의 표준오차에 대한 불편추정량 = SEa</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="sc">-</span><span class="fl">0.373</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>tA <span class="ot">=</span> a<span class="sc">/</span>SEa</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>tA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2904094</code></pre>
</div>
</div>
<section id="검정통계량을-이용하여-p-value-계산-1" class="level5">
<h5 class="anchored" data-anchor-id="검정통계량을-이용하여-p-value-계산-1">검정통계량을 이용하여 p-value 계산</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(tA,<span class="dv">1</span>) <span class="co">#양측검정이므로 2를 곱했다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8200689</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="r에서-확인하는-방법-1" class="level3">
<h3 class="anchored" data-anchor-id="r에서-확인하는-방법-1">R에서 확인하는 방법</h3>
<p>이를 R에서 회귀분석 객체에 대한 <code>summary()</code>를 보고 파악할 수 있다.</p>
<section id="회귀분석-lm의-summary-1" class="level4">
<h4 class="anchored" data-anchor-id="회귀분석-lm의-summary-1">1) 회귀분석 lm()의 summary()</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">=</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x)

Residuals:
      1       2       3 
 0.3433 -0.6867  0.3433 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  -0.3733     1.2846  -0.291    0.820
x             2.7200     0.5947   4.574    0.137

Residual standard error: 0.841 on 1 degrees of freedom
Multiple R-squared:  0.9544,    Adjusted R-squared:  0.9088 
F-statistic: 20.92 on 1 and 1 DF,  p-value: 0.137</code></pre>
</div>
</div>
<p><code>Coefficients</code>에서 <code>(Intercept)</code>행에 <span class="math inline">\(\alpha\)</span>에 대한 추정값 a, a의 표준오차에 대한 추정값, a의 검정통계량, 검정통계량에 의한 p값을 확인할 수 있다.</p>
</section>
<section id="confint로-신뢰구간-확인하기-1" class="level4">
<h4 class="anchored" data-anchor-id="confint로-신뢰구간-확인하기-1">2) confint()로 신뢰구간 확인하기</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M1,<span class="at">parm =</span> <span class="st">'(Intercept)'</span>,<span class="at">level=</span><span class="fl">0.80</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 10 %     90 %
(Intercept) -4.327035 3.580369</code></pre>
</div>
</div>
<p>x행에서 신뢰수준 80%일때 <span class="math inline">\(\alpha\)</span>에 대한 추정량 a의 신뢰구간을 확인할 수 있다.</p>
<hr>
</section>
</section>
</section>
<section id="예제6-ey와-y의-신뢰구간-차이" class="level2">
<h2 class="anchored" data-anchor-id="예제6-ey와-y의-신뢰구간-차이">6. [예제6] E(Y)와 Y의 신뢰구간 차이</h2>
<p><img src="./images/no1-7.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(1)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A대학교의 학생 평균키에 대한 추정값 = 170cm</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A대학교 학생 평균키의 표준편차</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">=</span> <span class="dv">10</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">100</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% 신뢰구간을 경험에 의한 법칙을 이용하면</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="dv">170</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 168</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="dv">170</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 172</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(2)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A대학교의 학생키에 대한 추정값 = 170cm</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% 신뢰구간을 경험에 의한 법칙을 이용하면</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="dv">170</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 150</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="dv">170</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 190</code></pre>
</div>
</div>
<hr>
</section>
<section id="예제7-ey와-y의-신뢰구간-차이-이해하기" class="level2">
<h2 class="anchored" data-anchor-id="예제7-ey와-y의-신뢰구간-차이-이해하기">7. [예제7] E(Y)와 Y의 신뢰구간 차이 이해하기</h2>
<p><img src="./images/no1-8.png" class="img-fluid"></p>
<section id="성질7에-나타난-통계량" class="level3">
<h3 class="anchored" data-anchor-id="성질7에-나타난-통계량">(성질7)에 나타난 통계량</h3>
<ol type="1">
<li>Y에 대한 기댓값 E(Y)에 대한 추정량</li>
<li>Y에 대한 추정량</li>
</ol>
</section>
<section id="predict를-이용하여-r에서-확인하는-방법" class="level3">
<h3 class="anchored" data-anchor-id="predict를-이용하여-r에서-확인하는-방법">predict()를 이용하여 R에서 확인하는 방법</h3>
<section id="ey에-대한-추정량과-신뢰구간" class="level4">
<h4 class="anchored" data-anchor-id="ey에-대한-추정량과-신뢰구간">1) E(Y)에 대한 추정량과 신뢰구간</h4>
<p><strong>predict()에 interval = ‘confidence’ argument 사용</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)),<span class="at">interval=</span><span class="st">'confidence'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit       lwr      upr
1 2.346667 -7.408099 12.10143
2 5.066667 -1.102789 11.23612
3 7.786667 -1.968099 17.54143</code></pre>
</div>
</div>
<p>각 행은 x=1, x=2, x=3일 경우를 나타낸다.</p>
<p>fit 열에 추정값이 나오고 lwr,upr은 95% 신뢰구간의 상한,하한을 나타낸다.</p>
</section>
<section id="y에-대한-추정량과-신뢰구간" class="level4">
<h4 class="anchored" data-anchor-id="y에-대한-추정량과-신뢰구간">2) Y에 대한 추정량과 신뢰구간</h4>
<p><strong>predict()에 interval = ‘prediction’ argument 사용</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)),<span class="at">interval=</span><span class="st">'prediction'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit        lwr      upr
1 2.346667 -12.121988 16.81532
2 5.066667  -7.272244 17.40558
3 7.786667  -6.681988 22.25532</code></pre>
</div>
</div>
<section id="두-추정량의-신뢰구간-차이-의미" class="level5">
<h5 class="anchored" data-anchor-id="두-추정량의-신뢰구간-차이-의미">두 추정량의 신뢰구간 차이 의미</h5>
<p>E(Y)에 대한 추정량과 Y에 대한 추정량은 동일하지만, 신뢰구간에서 차이가 있음을 볼 수 있다. E(Y)에 대한 추정량의 신뢰구간이 Y에 대한 추정량의 신뢰구간보다 작다.</p>
<p>이는 두 추정량의 분산이 <span class="math inline">\(\sigma^2\)</span> 만큼 차이가 나기 때문이다. <span class="math inline">\(\sigma^2\)</span>의 불편추정량은 MSE이므로 두 추정량의 분산은 MSE만큼 차이가 난다.</p>
</section>
<section id="x-xbar2항" class="level5">
<h5 class="anchored" data-anchor-id="x-xbar2항">(x-xbar)^2항</h5>
<p>Y에 대한 추정량의 신뢰구간 크기를 살펴보면 x=2일 경우 가장 작은 것을 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="fu">predict</span>(M1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)),<span class="at">interval=</span><span class="st">'prediction'</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">=</span> P[i,<span class="st">'upr'</span>]<span class="sc">-</span>P[i,<span class="st">'lwr'</span>]  </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diff)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28.93731
[1] 24.67782
[1] 28.93731</code></pre>
</div>
</div>
<p>x 평균값이 2이기 때문에 x=2일때 신뢰구간 폭이 가장 작은 것이다.</p>
<p>왜냐하면, x = 2일때, Y에 대한 추정량의 분산에서 <span class="math inline">\((x-\bar{x})^2\)</span> 이 0이 되기 때문이다.</p>
<p><img src="./images/no1-9.png" class="img-fluid"></p>
<hr>
</section>
</section>
</section>
</section>
<section id="잔차분석회귀진단-실습" class="level2">
<h2 class="anchored" data-anchor-id="잔차분석회귀진단-실습">8. 잔차분석(회귀진단) 실습</h2>
<section id="데이터준비" class="level3">
<h3 class="anchored" data-anchor-id="데이터준비">1) 데이터준비</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="st">'아파트매매.xlsx'</span>,<span class="at">range =</span> <span class="st">'B4:E30'</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
</div>
<p>티블(tibble)인 df1을 데이터프레임으로 변경한다.</p>
<p>티블은 변환과정에서 행이름을 유지하지않고 매번 변경한다. 이렇게 되면, 영향점을 찾기 어려워지므로 데이터프레임으로 클래스를 변경한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="fu">as.data.frame</span>(df1)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sales Dur Area Rooms
1 138.0  74   21     4
2 246.0 320   54     7
3 242.4 160   49     6
4 145.2 175   24     4
5 186.0  69   31     6
6 182.1 151   28     4</code></pre>
</div>
</div>
</section>
<section id="회귀분석" class="level3">
<h3 class="anchored" data-anchor-id="회귀분석">2) 회귀분석</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">=</span> <span class="fu">lm</span>(Sales<span class="sc">~</span>Area,df1)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ Area, data = df1)

Residuals:
    Min      1Q  Median      3Q     Max 
-44.911 -12.668   0.118  13.773  32.511 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  53.2303    14.1499   3.762  0.00096 ***
Area          4.4015     0.4183  10.522  1.8e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.52 on 24 degrees of freedom
Multiple R-squared:  0.8218,    Adjusted R-squared:  0.8144 
F-statistic: 110.7 on 1 and 24 DF,  p-value: 1.804e-10</code></pre>
</div>
</div>
<p>회귀모형에 대한 유의성은 F검정의 p값으로 입증되었다.<span class="math inline">\(p-value=1.804\times10^{-10}\)</span></p>
</section>
<section id="잔차분석-gvlma" class="level3">
<h3 class="anchored" data-anchor-id="잔차분석-gvlma">3) 잔차분석 gvlma()</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gvlma</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ Area, data = df1)

Coefficients:
(Intercept)         Area  
     53.230        4.401  


ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
Level of Significance =  0.05 

Call:
 gvlma(x = M1) 

                     Value  p-value                   Decision
Global Stat        9.95806 0.041140 Assumptions NOT satisfied!
Skewness           0.35702 0.550164    Assumptions acceptable.
Kurtosis           0.02303 0.879387    Assumptions acceptable.
Link Function      8.51237 0.003527 Assumptions NOT satisfied!
Heteroscedasticity 1.06565 0.301931    Assumptions acceptable.</code></pre>
</div>
</div>
<p><code>gvlma()</code>의 귀무가설은 ’잔차가 선형성과 정규성을 잘 따른다.’이다. 그러므로, 귀무가설이 기각되면 (p값이 유의수준보다 작으면) 문제가 있는 것이다.</p>
<p>Global Stat, Link Function 항목을 보면 가정에 문제가 있는 것으로 나타난다. 이는, <strong>모형의 선형성 가정에 문제가 있음을 암시한다.</strong></p>
</section>
<section id="산점도---면적에-따른-아파트-매매가격-잔차와-예측값" class="level3">
<h3 class="anchored" data-anchor-id="산점도---면적에-따른-아파트-매매가격-잔차와-예측값">4) 산점도 - 면적에 따른 아파트 매매가격 / 잔차와 예측값</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df1<span class="sc">$</span>Area,df1<span class="sc">$</span>Sales, <span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.2</span>, <span class="at">xlab =</span> <span class="st">'면적 (단위: 평)'</span>, <span class="at">ylab =</span> <span class="st">'매매가격 (단위: 백만원)'</span>, <span class="at">main =</span> <span class="st">'면적에 따른 아파트 매매가격 변화'</span>, <span class="at">family=</span> <span class="st">'Noto Sans KR'</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(M1, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ch21_LinearRegression_files/figure-html/면적%20-%20아파트-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><code>plot()</code>에서 <code>pch</code>는 기호(점)의 모양을 결정하는 parameter이다.(아래 그림 확인) <img src="./images/pch.png" class="img-fluid"></p>
<p><code>cex</code>는 기호(점)의 크기를 결정한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(M1),<span class="fu">rstudent</span>(M1), <span class="at">xlab =</span> <span class="st">'예측값'</span>, <span class="at">ylab =</span> <span class="st">'외적 스튜던트화된 잔차'</span>, <span class="at">main =</span> <span class="st">'예측값에 따른 외적 스튜던트화된 잔차'</span>, <span class="at">family =</span> <span class="st">'Noto Sans KR'</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ch21_LinearRegression_files/figure-html/예측값%20-%20잔차-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><code>fitted(M1)</code>은 M1 회귀분석에 의해 적합한, 즉 예측한 값을 보여준다. <code>rstudent(M1)</code>은 M1 회귀분석의 잔차를 외적 스튜던트화한다.</p>
</section>
<section id="극단값-레버리지-dffits통계량-cooks-d-통계량" class="level3">
<h3 class="anchored" data-anchor-id="극단값-레버리지-dffits통계량-cooks-d-통계량">5) 극단값, 레버리지, DFFITS통계량, Cooks’ D 통계량</h3>
<section id="극단값-outlier" class="level4">
<h4 class="anchored" data-anchor-id="극단값-outlier">5-1) 극단값 outlier</h4>
<p>표준화 혹은 스튜던트화된 잔차는 평균0, 표준편차 1의 분포를 따라야 한다. 그러나 <span class="math inline">\(\pm2\)</span>이상이라면, mild outlier, <span class="math inline">\(\pm3\)</span>이상이라면 extreme outlier로 판단한다.</p>
<p>본 실습에선 외적 스튜던트화한 잔차가 <span class="math inline">\(\pm1.5\)</span> 이상인 데이터를 극단값으로 봤다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rstudent</span>(M1))<span class="sc">&gt;</span><span class="fl">1.5</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>outliers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8     9    10    11    12    13 
FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(df1[outliers,],<span class="at">rstud =</span> <span class="fu">rstudent</span>(M1)[outliers])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sales Dur Area Rooms     rstud
2  246.0 320   54     7 -3.410073
3  242.4 160   49     6 -1.628257
12 257.4 125   39     5  1.906398
13 234.0  83   35     5  1.512461</code></pre>
</div>
</div>
</section>
<section id="레버리지-leverage-hat-value" class="level4">
<h4 class="anchored" data-anchor-id="레버리지-leverage-hat-value">5-2) 레버리지 leverage, hat value</h4>
<p>레버리지는 <span class="math inline">\((x-\bar{x})^2\)</span>값인데 이는 레버리지가 x값이 평균으로 부터 멀리 떨어질 수록 커짐을 의미한다. 레버리지는 hat value라고 부르며, R에서도 <code>hatvalues()</code>를 이용하여 알 수 있다.</p>
<p>hat value는 모든 데이터 n개가 균등한 영향을 미쳐서 <span class="math inline">\(1/n\)</span> 인게 가장 이상적이다. 이보다 2 ~4배 높은 값을 가지면 높은 레버리지를 갖는다고 판단한다.</p>
<p>본 실습에선 4배의 값을 가지면 높은 레버리지를 갖는다고 판단했다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>leverage <span class="ot">=</span> <span class="fu">hatvalues</span>(M1) <span class="sc">&gt;</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">26</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>leverage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8     9    10    11    12    13 
FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(df1[leverage,],<span class="at">hatv =</span> <span class="fu">hatvalues</span>(M1)[leverage])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sales Dur Area Rooms      hatv
2  246.0 320   54     7 0.2701578
3  242.4 160   49     6 0.1741776
15 126.0  62   16     4 0.1806548</code></pre>
</div>
</div>
</section>
<section id="dffits" class="level4">
<h4 class="anchored" data-anchor-id="dffits">5-3) DFFITS</h4>
<p>DFFITS 통계량은 모든 데이터(n개)를 이용하여 만들어진 i번째 예측값 <span class="math inline">\(\hat{y_i}\)</span>와 i번째 데이터를 제거하고 (n-1)개의 데이터만으로 예측한 i번째 예측값 <span class="math inline">\(\hat{y}_{(-i)}\)</span>의 차이를 스튜던트화한 수치이다.</p>
<p>DFFITS 통계량 수치가 크면 <span class="math inline">\(\hat{y_i}\)</span>와 <span class="math inline">\(\hat{y}_{(-i)}\)</span>의 차이가 크다는 의미이기 때문에 i번째 데이터의 영향력이 매우 큼을 보여준다.</p>
<p>DFFITS 통계량이 <span class="math inline">\(2\sqrt{3/(n-3)}\)</span>이상이면 영향점이라 판단할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>Dffits <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">dffits</span>(M1)) <span class="sc">&gt;</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">3</span><span class="sc">/</span>(<span class="dv">26-3</span>))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>Dffits</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8     9    10    11    12    13 
FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(df1[Dffits,],<span class="at">dffi=</span><span class="fu">dffits</span>(M1)[Dffits])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sales Dur Area Rooms       dffi
2 246.0 320   54     7 -2.0747129
3 242.4 160   49     6 -0.7477835</code></pre>
</div>
</div>
</section>
<section id="cooks-d" class="level4">
<h4 class="anchored" data-anchor-id="cooks-d">5-4) Cook’s D</h4>
<p>DFFITS 통계량은 i번째 예측값(1개)만 비교하지만, Cook’s D 통계량은 모든 예측값(n-1개)의 차이를 고려한다. 즉, i번째 데이터가 있는 상태에서의 모든 예측값과 i번째 데이터가 없는 상태에서의 모든 예측값을 비교한다는 것이다.</p>
<p>Cook’s D 통계량은 SSE의 자유도인 n-2를 균등 배분한 <span class="math inline">\(1/(n-2)\)</span> 값을 갖는 것이 이상적이다. 이보다 4배 이상 큰 값 즉, <span class="math inline">\(4/(n-2)\)</span>이상을 가지면 이상점으로 판단 할 수 있다.</p>
<p>0.5보다 크면 의심가는 영향점이고, 1보다 크면 거의 확실한 영향점으로 판단한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>CookD <span class="ot">=</span> <span class="fu">cooks.distance</span>(M1) <span class="sc">&gt;</span> <span class="dv">4</span><span class="sc">/</span>(<span class="dv">26-2</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>CookD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8     9    10    11    12    13 
FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(df1[CookD,],<span class="at">CookD =</span> <span class="fu">cooks.distance</span>(M1)[CookD])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sales Dur Area Rooms     CookD
2 246.0 320   54     7 1.4916342
3 242.4 160   49     6 0.2615923</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ch21_LinearRegression_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="영향점-제거-후-회귀분석" class="level3">
<h3 class="anchored" data-anchor-id="영향점-제거-후-회귀분석">6) 영향점 제거 후 회귀분석</h3>
<p>영향점으로 판단한 2, 3번 데이터를 제거한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">=</span> df1[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>영향점을 제거한 데이터 <code>df2</code>로 다시 회귀분석 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">=</span> <span class="fu">lm</span>(Sales<span class="sc">~</span>Area, df2)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ Area, data = df2)

Residuals:
    Min      1Q  Median      3Q     Max 
-26.239  -7.583  -2.715   8.064  19.523 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  16.6323    11.5252   1.443    0.163    
Area          5.6729     0.3612  15.705 1.94e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.41 on 22 degrees of freedom
Multiple R-squared:  0.9181,    Adjusted R-squared:  0.9144 
F-statistic: 246.6 on 1 and 22 DF,  p-value: 1.944e-13</code></pre>
</div>
</div>
<p>회귀모형에 대한 유의성은 F검정의 p값으로 입증되었다.<span class="math inline">\(p-value=1.942\times10^{-13}\)</span></p>
<p><code>Adjusted R-squared:  0.9144</code>로 매우 높은 적합도를 갖고 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gvlma</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ Area, data = df2)

Coefficients:
(Intercept)         Area  
     16.632        5.673  


ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
Level of Significance =  0.05 

Call:
 gvlma(x = M2) 

                     Value p-value                Decision
Global Stat        1.39657  0.8448 Assumptions acceptable.
Skewness           0.03149  0.8592 Assumptions acceptable.
Kurtosis           0.22197  0.6375 Assumptions acceptable.
Link Function      1.12601  0.2886 Assumptions acceptable.
Heteroscedasticity 0.01710  0.8960 Assumptions acceptable.</code></pre>
</div>
</div>
<p><code>gvlma()</code>를 통한 잔차분석 결과 모든 p값이 높기 때문에 안정적이라 볼 수 있다.</p>
<p>영향점을 제거하기 전과 후의 회귀방정식은 완전히 다르다.</p>
<p><em>제거전</em></p>
<p><span class="math inline">\(\hat{y} = 53.2283 + 4.4016x\)</span></p>
<p><em>제거후</em></p>
<p><span class="math inline">\(\hat{y} = 16.6267 + 5.6732x\)</span></p>
<section id="잔차의-독립성-검정" class="level4">
<h4 class="anchored" data-anchor-id="잔차의-독립성-검정">잔차의 독립성 검정</h4>
<p>Durbin-Watson 검정으로 잔차 간 독립성 검정을 실행한다. 이 검정은 자기상관계수(autocorrelation)가 0이라는(상관관계가 없다는) 귀무가설에 대한 검정이다.</p>
<p><code>car::durbinWatsonTest()</code>를 이용한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> lag Autocorrelation D-W Statistic p-value
   1     -0.05941592      2.109097   0.806
 Alternative hypothesis: rho != 0</code></pre>
</div>
</div>
<p>p값이 0.782로 유의수준 5%에서는 귀무가설을 기각할 수 없다. 그러므로 독립성 가정에 큰 무리가 없다고 판단할 수 있다.</p>
</section>
<section id="오차항에-대한-불편성데이터-수집에-바이어스-있는지-검정" class="level4">
<h4 class="anchored" data-anchor-id="오차항에-대한-불편성데이터-수집에-바이어스-있는지-검정">오차항에 대한 불편성(데이터 수집에 바이어스 있는지) 검정</h4>
<p>이는 데이터 측정과정에서 발생할 수 있는 오차를 검정하는 것이기에, 본 실습에서는 정보의 제약으로 진행하기 어렵다.</p>
</section>
<section id="잔차의-등분산성-가정-검정" class="level4">
<h4 class="anchored" data-anchor-id="잔차의-등분산성-가정-검정">잔차의 등분산성 가정 검정</h4>
<p><code>car::ncvTest()</code>의 귀무가설은 ’등분산성을 만족한다’이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncvTest</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01436403, Df = 1, p = 0.9046</code></pre>
</div>
</div>
<p>p값이 0.90496으로 매우 높기 때문에 유의수준 5%에선 기각할 수 없다. 그러므로, 등분산성 가정이 깨지지 않았다고 보는 것이 타당하다.</p>
</section>
<section id="잔차의-정규성-검정" class="level4">
<h4 class="anchored" data-anchor-id="잔차의-정규성-검정">잔차의 정규성 검정</h4>
<p><code>shapiro.test()</code>를 이용한다. 이때 <code>residuals()</code>로 회귀분석에 의해 적합한 회귀모형의 잔차를 추출하여 그 값을 <code>shapiro.test()</code>의 인수로 넣어야 한다.</p>
<p><code>shapiro.test()</code>의 귀무가설은 ’잔차가 정규분포를 따른다.’이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(M2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(M2)
W = 0.93637, p-value = 0.1353</code></pre>
</div>
</div>
<p>p값이 0.1357로 유의수준 5%에서 귀무가설을 기각할 수 없다. 잔차가 정규분포를 따른다고 볼 수 있다.</p>
</section>
<section id="영향점-제거-전후-slp-그래프-비교" class="level4">
<h4 class="anchored" data-anchor-id="영향점-제거-전후-slp-그래프-비교">영향점 제거 전후 slp 그래프 비교</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(M1,<span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(M2,<span class="at">which =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ch21_LinearRegression_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>왼쪽은 영향점 제거전 M1의 slp(scale-location plot)그래프, 오른쪽은 영향점을 제거한 M2의 slp이다.</p>
<p>M1의 slp는 예측값이 커질수록 잔차가 커지는 반면, M2의 slp는 비교적 안정적인 그래프를 보여준다.</p>
</section>
<section id="변수-변환" class="level4">
<h4 class="anchored" data-anchor-id="변수-변환">변수 변환</h4>
<section id="power-변환" class="level5">
<h5 class="anchored" data-anchor-id="power-변환">power 변환</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slp</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ch21_LinearRegression_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Suggested power transformation:  1.020367 </code></pre>
</div>
</div>
<p><code>Suggested power transformation:  1.022764</code> 즉, <span class="math inline">\(\lambda\)</span>가 1에 가까우므로 변환이 필요 없음을 알 수 있다.</p>
</section>
<section id="box-cox-변환" class="level5">
<h5 class="anchored" data-anchor-id="box-cox-변환">Box-Cox 변환</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">powerTransform</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated transformation parameter 
       Y1 
0.1522993 </code></pre>
</div>
</div>
<p>하지만 Box-Cox변환에 의하면 <span class="math inline">\(\lambda\)</span>추정값이 0.15로 <span class="math inline">\(y^{0.15}\)</span>혹은 <span class="math inline">\(log(y)\)</span>변환을 제안하고 있다.</p>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>